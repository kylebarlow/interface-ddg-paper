\documentclass{article}
\usepackage[letterpaper, portrait, margin=1in]{geometry}
\usepackage[capitalise]{cleveref}
\usepackage{import}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{csvsimple}
\usepackage{longtable}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{minted}
\usepackage{caption}

\newcommand\ddg{$\Delta\Delta G$}

% A listing of the contents of each file supplied as Supporting Information
% should be included. For instructions on what should be included in the
% Supporting Information as well as how to prepare this material for
% publications, refer to the journal's Instructions for Authors.

% The following files are available free of charge.
% \begin{itemize}
% \item Filename: brief description
% \item Filename: brief description
% \end{itemize}

% Supplementary figures:
% \begin{itemize}
% \item \cref{tab:table-mult}
% \item \cref{fig:steps-v-corr}
% \item \cref{tab:table-versions}
% \item \cref{fig:structs-v-corr-id-zemu-12-60000-rscript-validated-t14}
% \item \cref{fig:structs-v-corr-WildTypeComplex-ddg-monomer-16-003-zemu-2}
% \item \cref{fig:wildtypecomplex-scores-complete}
% \item \cref{fig:spear-corr-rmsd-error}
% \item \cref{fig:t14-mean-ensemble}
% \item \cref{tab:table-ref}
% \item \cref{tab:table-antibodies}
% \item \cref{fig:t14-fits-feats}
% \end{itemize}

\begin{document}

\renewcommand{\thefigure}{S\arabic{figure}}
\setcounter{figure}{0}
\renewcommand{\thetable}{S\arabic{table}}
\setcounter{table}{0}
% \renewcommand{\lstlistingname}{Supporting Listing}

% \subimport*{figs-and-tables/}{table-mult}
\subimport*{figs-and-tables/}{steps-v-corr}
\subimport*{figs-and-tables/}{table-versions}
\subimport*{figs-and-tables/}{table-stabilizing}
% \subimport*{figs-and-tables/}{table-antibodies}

\clearpage
\input{table-by-structure}
\clearpage

\subimport*{figs-and-tables/}{structs-v-corr-id-zemu-12-60000-rscript-validated-t14}
\subimport*{figs-and-tables/}{structs-v-corr-WildTypeComplex-ddg-monomer-16-003-zemu-2}

\begin{figure}
  \centering
  \includegraphics[width=\textwidth,keepaspectratio]{figures/wildtypecomplex-scores-complete.pdf}
  \caption{
    Contour plot showing the effect of backrub sampling on the average wild-type complex score, for varying numbers of averaged models.
  } \label{fig:wildtypecomplex-scores-complete}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=\textwidth,keepaspectratio]{figures/t14-mean-ensemble-error.pdf}
  \caption{
    Mean backrub ensemble RMSD vs. backrub steps.
  } \label{fig:t14-mean-ensemble}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=\textwidth,keepaspectratio]{figures/t14-spear-corr.pdf}
  \caption[\ddg\ prediction error vs. ensemble RMSD]{
    Scatter plot showing the average Spearman correlation of ddG prediction error v. mean pairwise backrub ensemble RMSD, v. backrub steps.
    As mean backrub ensemble RMSD increases (\cref{fig:t14-mean-ensemble}), we don't see any significant change in correlation between mean ensemble RMSD and ddG error.
    This demonstrates that mean pairwise backrub ensemble RMSD is not an effective metric to measure the degree to which we have sampled ``enough''.
  } \label{fig:spear-corr-rmsd-error}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=\textwidth,keepaspectratio]{figures/zemu-sigmoid2-tal-feats.png}
  \caption[Sigmoid fit Rosetta score function terms]{
    Rosetta interface \ddg\ score function terms fit on interface \ddg\ predictions via a sigmoid git Generalized Additive Model. (Figure courtesy Markus Heinonen)
  } \label{fig:t14-fits-feats}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=\textwidth,keepaspectratio]{figures/zemu-sigmoid2-corrs.png}
  \caption[Interface \ddg prediction performance with sigmoid fit score function]{
    Left: standard, non-fitted predictions vs. experimental \ddg\ values. Right: Fit predictions vs. experimental data. Top: Control (no backrub) predictions. Middle: Backrub/talaris. Bottom: Backrub/REF. (Figure courtesy Markus Heinonen)
  } \label{fig:t14-fit-scatter}
\end{figure}

\subimport*{figs-and-tables/}{table-ref}

\clearpage

\csvreader[
longtable=|c|c|c|p{8cm}|r|,
table head=\caption{Filtered ZEMu dataset with experimental \ddg\ values}\label{tab:zemu-filtered}\\\hline
ID & PDB & Res. & Mutations & \ddg\\\hline
\endhead\hline\endfoot,
% \csvlinetotablerow\\\hline
% \endfirsthead\hline
% \csvlinetotablerow\\\hline
% \endhead\hline
% \endfoot,
]
{figures/table-zemu-filtered.csv}
{1=\DataSetID,2=\PDBFileID,3=\Resolution,4=\Mutations,5=\ExperimentalDDG}
{\DataSetID & \PDBFileID & \Resolution & \Mutations & \ExperimentalDDG}

\captionof{listing}{
  Flex ddg Rosetta Script implementation
  \label{lst:ddg-script}
}
\inputminted[
linenos=true,
% frame=single,
breaklines
]
{xml}
{listings/ddG-backrub.xml}

\clearpage

\end{document}